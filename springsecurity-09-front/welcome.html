<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>欢迎使用</title>
    <script src="js/axios.js"></script>
</head>
<body>
    <h1>欢迎登录!!</h1>
    <!--新增超链接,访问之前章节写的页面-->
    <a href="javascript:void(0)" onclick="getUserInfo()">获取用户信息</a>
    <a href="javascript:void(0)" onclick="logout()">退出登录</a><br>
    <!--
    举例，用户 id 为 3 的用户，他叫 zhangqi，拥有以下权限：
        线索管理-列表 clueList
        线索管理-录入 clueInput
        线索管理-编辑 clueEdit
        线索管理-查看 clueView
    没有以下权限：
        线索管理-删除 clueDel
        线索管理-导出 clueExport
    -->
    <a href="javascript:void(0)" onclick="clueList()">线索管理-列表</a>
    <a href="javascript:void(0)" onclick="clueInput()">线索管理-录入</a>
    <a href="javascript:void(0)" onclick="clueEdit()">线索管理-编辑</a>
    <a href="javascript:void(0)" onclick="clueView()">线索管理-列表</a><br>
    <a href="javascript:void(0)" onclick="clueDel()">线索管理-删除</a>
    <a href="javascript:void(0)" onclick="clueExport()">线索管理-导出</a>
</body>
<script type="text/javascript">
    function clueList(){
        let jwt = window.sessionStorage.getItem("jwt");
        axios({
            method: 'get',
            url: 'http://localhost:8080/api/clue/list',
            responseType: 'json',
            headers: {'jwt': jwt},
        }).then((resp) =>{
            console.log(resp)
        })
    }
    function clueInput(){
        let jwt = window.sessionStorage.getItem("jwt");
        axios({
            method: 'get',
            url: 'http://localhost:8080/api/clue/input',
            responseType: 'json',
            headers: {'jwt': jwt},
        }).then((resp) =>{
            console.log(resp)
        })
    }
    function clueEdit(){
        let jwt = window.sessionStorage.getItem("jwt");
        axios({
            method: 'get',
            url: 'http://localhost:8080/api/clue/edit',
            responseType: 'json',
            headers: {'jwt': jwt},
        }).then((resp) =>{
            console.log(resp)
        })
    }
    function clueView(){
        let jwt = window.sessionStorage.getItem("jwt");
        axios({
            method: 'get',
            url: 'http://localhost:8080/api/clue/view',
            responseType: 'json',
            headers: {'jwt': jwt},
        }).then((resp) =>{
            console.log(resp)
        })
    }
    function clueDel(){
        let jwt = window.sessionStorage.getItem("jwt");
        axios({
            method: 'get',
            url: 'http://localhost:8080/api/clue/del',
            responseType: 'json',
            headers: {'jwt': jwt},
        }).then((resp) =>{
            console.log(resp)
        })
    }
    function clueExport(){
        let jwt = window.sessionStorage.getItem("jwt");
        axios({
            method: 'get',
            url: 'http://localhost:8080/api/clue/xxyy',
            responseType: 'json',
            headers: {'jwt': jwt},
        }).then((resp) =>{
            console.log(resp)
        })
    }

    function logout(){
        // axios.get("http://localhost:8080/user/logout").then((resp) =>{
        //     console.log(resp.data);
        // }).catch((error) =>{
        //     console.log(error);
        // }).finally((e) =>{
        //     console.log(e);
        // })

        // 获取我们之前在 sessionStorage 存入的 JWT
        let jwt = window.sessionStorage.getItem("jwt");

        // 采用配置方式，请求后端，可以带入我们的 JWT
        axios({
            method: 'get',
            url: 'http://localhost:8080/user/logout',
            // 设置相应类型是 json
            responseType: 'json',
            // 这里自定义请求头，放入我们的 jwt,后续也不用这么写，因为它太重复了，每个请求都要怎么写，后续会使用 axios
            headers: {'jwt': jwt},
        }).then((resp) =>{
            console.log(resp)
        })
    }
    function getUserInfo(){
        // 这是直接调用方法，请求后端，我们不采用这种方式请求了，这种方式请求，无法带入我们的 JWT
        /*axios.get("http://localhost:8080/userInfo").then((resp) =>{
            console.log(resp.data);
        }).catch((error) =>{
            console.log(error);
        }).finally((e) =>{
            console.log(e);
        })*/

        // 获取我们之前在 sessionStorage 存入的 JWT
        let jwt = window.sessionStorage.getItem("jwt");

        // 采用配置方式，请求后端，可以带入我们的 JWT
        axios({
            method: 'get',
            url: 'http://localhost:8080/userInfo',
            // 设置相应类型是 json
            responseType: 'json',
            // 这里自定义请求头，放入我们的 jwt,后续也不用这么写，因为它太重复了，每个请求都要怎么写，后续会使用 axios
            headers: {'jwt': jwt},
        }).then((resp) =>{
            console.log(resp)
        })
    }
</script>
</html>